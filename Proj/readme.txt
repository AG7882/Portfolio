# Операционные системы UNIX/Linux (Базовый).

Установка и обновления системы Linux. Основы администрирования.

## Part 1. Установка ОС

**== Задание ==**

##### Установи **Ubuntu 20.04 Server LTS** без графического интерфейса. (Используем программу для виртуализации - VirtualBox)

**== Выполнение задания ==**

Выполнение команды `cat /etc/issue.`

![image1](./img/1-1.png)

## Part 2. Создание пользователя

**== Задание ==**

##### Создай пользователя, отличного от созданного при установке. Пользователь должен быть добавлен в группу `adm`.

**== Выполнение задания ==**

1) Вызов команды для создания пользователя.

![image2](./img/2-1.png)

2) Вывод команды `cat /etc/passwd`.

![image3](./img/2-2.png)

## Part 3. Настройка сети ОС

**== Задание ==**

##### Задай название машины вида user-1.
##### Установи временную зону, соответствующую твоему текущему местоположению.  
##### Выведи названия сетевых интерфейсов с помощью консольной команды.
- В отчёте дай объяснение наличию интерфейса lo.  
##### Используя консольную команду, получи ip адрес устройства, на котором ты работаешь, от DHCP сервера. 
- В отчёте дай расшифровку DHCP.  
##### Определи и выведи на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw). 
##### Задай статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (используй публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).  
##### Перезагрузи виртуальную машину. Убедись, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.  

- В отчёте опиши, что сделал для выполнения всех семи пунктов (можно как текстом, так и скриншотами).
- Успешно пропингуй удаленные хосты 1.1.1.1 и ya.ru и вставь в отчёт скрин с выводом команды. В выводе команды должна быть фраза «0% packet loss».

**== Выполнение задания ==**

1) Для задания названия используется sudo hostnamectl set-hostname user-1

2) Для задания временной зоны используется timedatectl set-timezone Asia/Yaekaterinburg

3) Вывод команды `ip a`.

![image4](./img/3-1.png)

lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux. 
Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине. 
С этим интерфейсом всегда связан адрес 127.0.0.1. У него есть dns-имя – localhost. 

4) Получить ip от DHCP сервера.

![image5](./img/3-2.png)

DHCP - Dynamic Host Configuration Protocol

5) В выводе следующей команды есть внутренний и внешний ip .

![image6](./img/3-3.png)

6) Для получения днс используется sudo vi /etc/network/interfaces
Строчка dns-nameserver 77.88.8.8

7) Задание статической адресации делается через netstat:

![image7](./img/3-4.png)


## Part 4. Обновление ОС

**== Задание ==**

##### Обнови системные пакеты до последней на момент выполнения задания версии.  

**== Выполнение задания ==**

Все пакеты обновлены:

![image8](./img/4-1.png)

## Part 5. Использование команды **sudo**

**== Задание ==**

##### Разреши пользователю, созданному в [Part 2](#part-2-создание-пользователя),выполнять команду sudo.

- В отчёте объясни *истинное* назначение команды sudo (про то, что это слово - «волшебное», писать не стоит);  
- Поменяй hostname ОС от имени пользователя, созданного в пункте [Part 2](#part-2-создание-пользователя) (используя sudo);
- Вставь скрин с изменённым hostname в отчёт.

**== Выполнение задания ==**

1) Sudo (англ. Substitute User and do, дословно «подменить пользователя и выполнить») - выполнение команды от имени другого пользователя

2) Смена имени:

![image9](./img/5-1.png)

3) После перезапуска имя изменено:

![image10](./img/5-2.png)

## Part 6. Установка и настройка службы времени

**== Задание ==**

##### Настрой службу автоматической синхронизации времени.  

- Выведи время часового пояса, в котором ты сейчас находишься.
- Вывод следующей команды должен содержать `NTPSynchronized=yes`: \
  `timedatectl show`
- Вставь скрины с корректным временем и выводом команды в отчёт.

**== Выполнение задания ==**

1) Для настройки автоматической синхронизации воспользуемся сервисом ntpdate:
- sudo apt install ntpdate
- sudo ntpdate pool.ntp.org



2) Вывод даты:

![image11](./img/6-1.png)

## Part 7. Установка и использование текстовых редакторов 

**== Задание ==**

##### Установи текстовые редакторы **VIM** (+ любые два по желанию **NANO**, **MCEDIT**, **JOE** и т.д.)  
##### Используя каждый из трех выбранных редакторов, создай файл *test_X.txt*, где X -- название редактора, в котором создан файл. Напиши в нём свой никнейм, закрой файл с сохранением изменений.  
- В отчёт вставь скриншоты:
  - Из каждого редактора с содержимым файла перед закрытием;
- В отчёте укажи, что сделал для выхода с сохранением изменений.
##### Используя каждый из трех выбранных редакторов, открой файл на редактирование, отредактируй файл, заменив никнейм на строку «21 School 21», закрой файл без сохранения изменений.
- В отчёт вставь скриншоты:
    - Из каждого редактора с содержимым файла после редактирования;
- В отчёте укажи, что сделал для выхода без сохранения изменений.
##### Используя каждый из трех выбранных редакторов, отредактируй файл ещё раз (по аналогии с предыдущим пунктом), а затем освой функции поиска по содержимому файла (слово) и замены слова на любое другое.
- В отчёт вставь скриншоты:
    - Из каждого редактора с результатами поиска слова;
    - Из каждого редактора с командами, введёнными для замены слова на другое.

**== Выполнение задания ==**

Для выполнения этого задания выбраны VIM, NANO и MCEDIT

1) VIM закрытие с сохраниением:

![image12](./img/7-1v.png)

2) VIM закрытие без сохраниения:

![image13](./img/7-2v.png)

3) VIM поиск:

![image14](./img/7-3v.png)

4) VIM замена:

![image15](./img/7-4v.png)

5) NANO закрытие с сохраниением:

![image16](./img/7-1n.png)

6) NANO закрытие без сохраниения:

![image17](./img/7-2n.png)

7) NANO поиск:

![image18](./img/7-3n.png)

8) NANO замена:

![image19](./img/7-4n.png)

9) MCEDIT закрытие с сохраниением:

![image20](./img/7-1m.png)

10) MCEDIT закрытие без сохраниения:

![image21](./img/7-2m.png)

11) MCEDIT поиск:

![image22](./img/7-3m.png)

12) MCEDIT замена:

![image23](./img/7-4m.png)

## Part 8. Установка и базовая настройка сервиса **SSHD**

**== Задание ==**

##### Установи службу SSHd.  
##### Добавь автостарт службы при загрузке системы.  
##### Перенастрой службу SSHd на порт 2022.  
##### Используя команду ps, покажи наличие процесса sshd. Для этого к команде нужно подобрать ключи.
- В отчёте объясни значение команды и каждого ключа в ней.
##### Перезагрузи систему.
- В отчёте опиши, что сделал для выполнения всех пяти пунктов (можно как текстом, так и скриншотами).
- Вывод команды netstat -tan должен содержать  \
`tcp 0 0 0.0.0.0:2022 0.0.0.0:* LISTEN`  \
(если команды netstat нет, то ее нужно установить)
- Скрин с выводом команды вставь в отчёт.
- В отчёте объясни значение ключей -tan, значение каждого столбца вывода, значение 0.0.0.0.

**== Выполнение задания ==**

1) Установка SSHd:
- sudo apt install openssh-server

2) Настройка автозапуска:
- sudo systemctl enable ssh

3) Настройка порта:

![image24](./img/8-1.png)

4) Процесс sshd:

![image25](./img/8-2.png)

5) Вывод netstat -tan после перезапуска:

![image26](./img/8-3.png)

tan выводит информацию о tcp соединениях

Выводимые поля для интернет соединений:

Proto — протокол (tcp, udp).
Recv-Q — количество байтов, помещённых в буфер приёма TCP/IP, но не переданных приложению. Если это число высокое, то нужно проверить работоспособность приложения, которое работает с данным портом.
Send-Q — количество байтов, помещённых в буфер отправки TCP/IP, но не отправленных, или отправленных, но не подтверждённых. Высокое значение может быть связано с перегрузкой сети сервера.
Local Address — локальный адрес сервера. В обычных соединения, это адрес сервера на который пришло соединение. В прослушиваемых портах (LISTEN) — это диапазон адресов. Так 0.0.0.0:port — значит подключаться можно ко всем адресам сервера, а 192.168.0.35:port — значит подключаться можно только к этому адресу сервера.
Foreign Address — адрес второй стороны. В обычных соединения, это адрес с которого пришло соединение. В прослушиваемых портах (LISTEN) — это диапазон адресов. Так 0.0.0.0:* — значит подключаться можно с любых адресов и с любых портов, а например 192.168.0.50:* — значит подключаться можно только с этого адреса и с любых портов.
State — состояние подключения, или прослушивания.


## Part 9. Установка и использование утилит **top**, **htop**

**== Задание ==**

##### Установи и запусти утилиты top и htop.  

- По выводу команды top определи и напиши в отчёте:
  - uptime
  - количество авторизованных пользователей
  - общую загрузку системы
  - общее количество процессов
  - загрузку cpu
  - загрузку памяти
  - pid процесса занимающего больше всего памяти
  - pid процесса, занимающего больше всего процессорного времени
- В отчёт вставь скрин с выводом команды htop:
  - отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
  - отфильтрованному для процесса sshd
  - с процессом syslog, найденным, используя поиск 
  - с добавленным выводом hostname, clock и uptime  

**== Выполнение задания ==**

1) Top:

![image27](./img/9-1.png)

  - uptime 17 min
  - количество авторизованных пользователей 1
  - общую загрузку системы 0.00
  - общее количество процессов 94
  - загрузку cpu 0%
  - загрузку памяти 1971.6
  - pid процесса занимающего больше всего памяти 1
  - pid процесса, занимающего больше всего процессорного времени 1111


2) Htop:

- Сортировка PID
![image28](./img/9-2.png)

- Сортировка PERCENT_CPU
![image29](./img/9-3.png)

- Сортировка PERCENT_MEM
![image30](./img/9-4.png)

- Сортировка TIME
![image31](./img/9-5.png)

- Сортировка процесса sshd
![image32](./img/9-6.png)

- Syslog
![image33](./img/9-7.png)

- Вывод hostname, clock и uptime
![image34](./img/9-8.png)

## Part 10. Использование утилиты **fdisk**

**== Задание ==**

##### Запусти команду fdisk -l.

- В отчёте напиши название жесткого диска, его размер и количество секторов, а также размер swap.

**== Выполнение задания ==**

Команда fdisk -l.
![image35](./img/10-1.png)
Имя - sda
Размер - 25Гб
Количество секторов - 52428800
Размер swap виден на след.скриншоте, это файл, а не раздел.
![image36](./img/10-s.png)

## Part 11. Использование утилиты **df** 

**== Задание ==**

##### Запусти команду df.  
- В отчёте напиши для корневого раздела (/):
  - размер раздела 
  - размер занятого пространства
  - размер свободного пространства
  - процент использования
- Определи и напиши в отчёт единицу измерения в выводе.  

##### Запусти команду df -Th.
- В отчёте напиши для корневого раздела (/):
    - размер раздела
    - размер занятого пространства
    - размер свободного пространства
    - процент использования
- Определи и напиши в отчёт тип файловой системы для раздела.

**== Выполнение задания ==**

1) df:  
![image37](./img/11-1.png)
- В отчёте напиши для корневого раздела (/):
  - размер раздела - 11758760
  - размер занятого пространства - 5358512
  - размер свободного пространства - 5781140
  - процент использования - 49
- Определи и напиши в отчёт единицу измерения в выводе - байт 

2) df -Th:
![image38](./img/11-2.png)
- В отчёте напиши для корневого раздела (/):
    - размер раздела - 12G
    - размер занятого пространства - 5.2G
    - размер свободного пространства - 5.6G
    - процент использования - 49
- Определи и напиши в отчёт тип файловой системы для раздела - ext4

## Part 12. Использование утилиты **du**

**== Задание ==**

##### Запусти команду du
##### Выведи размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)
##### Выведи размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

- В отчёт вставь скрины с выводом всех использованных команд.

**== Выполнение задания ==**

1) Команда du:
![image39](./img/12-1.png)

2) Размер папок /home, /var, /var/log:
![image40](./img/12-2.png)

3) Размер всего содержимого в /var/log:
![image41](./img/12-3.png)

## Part 13. Установка и использование утилиты **ncdu**

**== Задание ==**

##### Установи утилиту ncdu
##### Выведи размер папок /home, /var, /var/log

- Размеры должны примерно совпадать с полученными в [Part 12](#part-12-использование-утилиты-du).

- В отчёт вставь скрины с выводом использованных команд.

**== Выполнение задания ==**

1) Размер /home:
![image42](./img/13-1.png)

2) Размер /var:
![image43](./img/13-2.png)

3) Размер /var/log:
![image44](./img/13-3.png)

## Part 14. Работа с системными журналами

**== Задание ==**

##### Открой для просмотра:
##### 1. /var/log/dmesg
##### 2. /var/log/syslog
##### 3. /var/log/auth.log  

- Напиши в отчёте время последней успешной авторизации, имя пользователя и метод входа в систему;
- Перезапусти службу SSHd;
- Вставь в отчёт скрин с сообщением о рестарте службы (искать в логах).

**== Выполнение задания ==**

1) Авторизация:
![image45](./img/14-1.png)

Время - 17:08:32 
Имя пользователя - anton
Метод входа в систему - login

2) Рестарт sshd:
![image46](./img/14-2.png)

## Part 15. Использование планировщика заданий **CRON**

**== Задание ==**

##### Используя планировщик заданий, запусти команду uptime через каждые 2 минуты.
- Найди в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении;
- Выведи на экран список текущих заданий для CRON;
- Вставь в отчёт скрины со строчками о выполнении и списком текущих задач.

##### Удали все задания из планировщика заданий.
- В отчёт вставь скрин со списком текущих заданий для CRON.

**== Выполнение задания ==**

1) Строчки о выполнении:
![image47](./img/15-1.png)

2) Список текущих заданий для CRON:
![image48](./img/15-2.png)

3) Скрин со списком текущих заданий для CRON после удаления:
![image49](./img/15-3.png)


